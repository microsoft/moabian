#!/usr/bin/python3

# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.
import serial       # PySerial
import time

# Interactive TTY shell with Moab Hat:
# sudo minicom --device=/dev/ttyAMA1

def main():
    ser = serial.Serial('/dev/ttyAMA1', 115200, timeout = 1)

    ser.write("version\n".encode())
    out_a = ser.read_until(b'uart')       # read until the "uart" prompt it seen

    out_u = out_a.decode('ascii')

    # 0: version\n
    # 1: Moab version 3.0.1.04321
    # 2: uart

    print(out_u.splitlines()[1])

if __name__ == "__main__":
    main()
